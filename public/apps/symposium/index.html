<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>The Symposium — Olympus</title>

    <!-- Firebase SDK (compat) -->
    <script defer src="/__/firebase/12.9.0/firebase-app-compat.js"></script>
    <script defer src="/__/firebase/12.9.0/firebase-auth-compat.js"></script>
    <script defer src="/__/firebase/12.9.0/firebase-firestore-compat.js"></script>
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>

    <!-- Shared Olympus styles -->
    <link rel="stylesheet" href="/styles/app.css" />

    <!-- App-specific styles -->
    <link rel="stylesheet" href="/apps/symposium/symposium.css" />
  </head>
  <body>
    <!-- Shared header — rendered by app-header.js -->
    <div id="appHeader"></div>

    <!-- Auth guard — shown while checking auth state -->
    <div class="app-loading" id="app-loading">
      <div class="app-spinner"></div>
      <p class="app-loading-text">Consulting the Oracle&hellip;</p>
    </div>

    <!-- Main content — hidden until authenticated -->
    <main class="app-main hidden" id="app-main">
      <h1 class="app-title">The Symposium</h1>
      <p class="app-subtitle">Where Dionysus keeps his ledger</p>
      <div class="app-divider"></div>

      <!-- Inventory summary dashboard card -->
      <div class="inventory-dashboard" id="inventory-dashboard">
        <div class="dashboard-stat">
          <span class="dashboard-count" id="dash-ingredient-count">0</span>
          <span class="dashboard-label">Ingredients</span>
        </div>
        <div class="dashboard-stat">
          <span class="dashboard-count" id="dash-equipment-count">0</span>
          <span class="dashboard-label">Equipment</span>
        </div>
        <div class="dashboard-stat" id="dash-alert-stat">
          <span class="dashboard-count" id="dash-alert-count">0</span>
          <span class="dashboard-label">Low / Empty</span>
        </div>
        <div class="dashboard-stat">
          <span class="dashboard-count" id="dash-recipe-count">0</span>
          <span class="dashboard-label">Recipes</span>
        </div>
      </div>

      <!-- Global oracle search bar (searches all inventory) -->
      <div class="oracle-search-row">
        <div class="oracle-search-wrapper">
          <span class="oracle-search-icon" aria-hidden="true">&#x1f52e;</span>
          <input
            class="oracle-search-input"
            id="oracle-search-global"
            type="text"
            placeholder="Search all inventory&hellip;"
            autocomplete="off"
          />
          <button
            class="oracle-clear-btn hidden"
            id="oracle-clear-global"
            type="button"
            aria-label="Clear search"
          >
            &#x2715;
          </button>
        </div>
      </div>

      <!-- View tabs: Ingredients / Equipment -->
      <div class="view-tabs" role="tablist" aria-label="Inventory view">
        <button
          class="view-tab active"
          id="tab-ingredients"
          type="button"
          role="tab"
          aria-selected="true"
          aria-controls="panel-ingredients"
          data-view="ingredients"
        >
          &#127863; Ingredients
        </button>
        <button
          class="view-tab"
          id="tab-equipment"
          type="button"
          role="tab"
          aria-selected="false"
          aria-controls="panel-equipment"
          data-view="equipment"
        >
          &#128295; Equipment
        </button>
        <button
          class="view-tab"
          id="tab-recipes"
          type="button"
          role="tab"
          aria-selected="false"
          aria-controls="panel-recipes"
          data-view="recipes"
        >
          &#127860; Recipes
        </button>
      </div>

      <!-- Combined search results panel (shown when global search is active) -->
      <div id="panel-combined" class="hidden" role="region" aria-label="Search results">
        <div class="combined-count hidden" id="combined-count"></div>
        <div class="combined-list" id="combined-list"></div>
        <div class="empty-state" id="empty-state-combined">
          <span class="empty-state-icon" aria-hidden="true">&#x1f52e;</span>
          <p class="empty-state-text">The Oracle found nothing.</p>
        </div>
      </div>

      <!-- Ingredients panel -->
      <div id="panel-ingredients" role="tabpanel" aria-labelledby="tab-ingredients">
        <div class="toolbar">
          <button class="app-btn" id="btn-add" type="button">+ Add Ingredient</button>
        </div>

        <!-- Browse controls: sort + stock filter -->
        <div class="browse-controls-row">
          <div class="sort-group">
            <label class="sort-label" for="sort-select">Sort</label>
            <select class="sort-select" id="sort-select">
              <option value="category">Category</option>
              <option value="alpha">Alphabetical</option>
              <option value="stock">Stock Status</option>
            </select>
          </div>
          <div class="stock-toggle-group" role="group" aria-label="Stock filter">
            <button
              class="stock-toggle-btn active"
              id="stock-btn-all"
              type="button"
              data-filter="all"
            >
              All
            </button>
            <button class="stock-toggle-btn" id="stock-btn-in" type="button" data-filter="in-stock">
              In Stock
            </button>
            <button
              class="stock-toggle-btn"
              id="stock-btn-out"
              type="button"
              data-filter="out-of-stock"
            >
              Out of Stock
            </button>
          </div>
        </div>

        <!-- Category browse grid -->
        <div class="category-grid" id="category-grid"></div>

        <div class="ingredient-count hidden" id="ingredient-count"></div>

        <div class="ingredient-list" id="ingredient-list"></div>

        <div class="empty-state" id="empty-state">
          <span class="empty-state-icon" aria-hidden="true">&#127863;</span>
          <p class="empty-state-text">The Cellar awaits its first offering.</p>
        </div>
      </div>

      <!-- Equipment panel -->
      <div id="panel-equipment" role="tabpanel" aria-labelledby="tab-equipment" class="hidden">
        <div class="toolbar">
          <button class="app-btn app-btn-equipment" id="btn-add-equipment" type="button">
            + Add Equipment
          </button>
        </div>

        <!-- Browse controls: sort + condition filter -->
        <div class="browse-controls-row">
          <div class="sort-group">
            <label class="sort-label" for="sort-select-equip">Sort</label>
            <select class="sort-select" id="sort-select-equip">
              <option value="category">Category</option>
              <option value="alpha">Alphabetical</option>
              <option value="condition">Condition</option>
            </select>
          </div>
          <div class="condition-toggle-group" role="group" aria-label="Condition filter">
            <button
              class="condition-toggle-btn active"
              id="cond-btn-all"
              type="button"
              data-filter="all"
            >
              All
            </button>
            <button
              class="condition-toggle-btn"
              id="cond-btn-good"
              type="button"
              data-filter="good"
            >
              Good
            </button>
            <button
              class="condition-toggle-btn"
              id="cond-btn-fair"
              type="button"
              data-filter="fair"
            >
              Fair
            </button>
            <button
              class="condition-toggle-btn"
              id="cond-btn-replace"
              type="button"
              data-filter="replace"
            >
              Replace
            </button>
          </div>
        </div>

        <!-- Category browse grid (equipment) -->
        <div class="category-grid" id="category-grid-equip"></div>

        <div class="equipment-count hidden" id="equipment-count"></div>

        <div class="equipment-list" id="equipment-list"></div>

        <div class="empty-state" id="empty-state-equip">
          <span class="empty-state-icon" aria-hidden="true">&#128295;</span>
          <p class="empty-state-text">The Workshop awaits its first tool.</p>
        </div>
      </div>

      <!-- Recipes panel -->
      <div id="panel-recipes" role="tabpanel" aria-labelledby="tab-recipes" class="hidden">
        <div class="toolbar">
          <button class="app-btn app-btn-recipe" id="btn-add-recipe" type="button">
            + Add Recipe
          </button>
        </div>

        <!-- Browse controls: sort + favorite filter -->
        <div class="browse-controls-row">
          <div class="sort-group">
            <label class="sort-label" for="sort-select-recipe">Sort</label>
            <select class="sort-select" id="sort-select-recipe">
              <option value="category">Category</option>
              <option value="alpha">Alphabetical</option>
              <option value="favorite">Favorites First</option>
            </select>
          </div>
          <div class="favorite-toggle-group" role="group" aria-label="Favorite filter">
            <button
              class="favorite-toggle-btn active"
              id="fav-btn-all"
              type="button"
              data-filter="all"
            >
              All
            </button>
            <button
              class="favorite-toggle-btn"
              id="fav-btn-yes"
              type="button"
              data-filter="favorites"
            >
              &#9733; Favorites
            </button>
          </div>
          <button
            class="can-make-toggle-btn"
            id="can-make-btn"
            type="button"
            title="Show only recipes I can make right now"
          >
            &#10003; Can Make
          </button>
        </div>

        <!-- Category browse grid (recipes) -->
        <div class="category-grid" id="category-grid-recipe"></div>

        <div class="recipe-count hidden" id="recipe-count"></div>

        <div class="recipe-list" id="recipe-list"></div>

        <div class="empty-state" id="empty-state-recipe">
          <span class="empty-state-icon" aria-hidden="true">&#127860;</span>
          <p class="empty-state-text">The Libations await their first offering.</p>
        </div>
      </div>
    </main>

    <!-- Modal overlay -->
    <div class="modal-overlay" id="modal-overlay">
      <div class="modal-dialog" role="dialog" aria-labelledby="modal-title">
        <h2 class="modal-title" id="modal-title">Add Ingredient</h2>
        <form id="ingredient-form" novalidate>
          <div class="form-grid">
            <div class="form-group full-width">
              <label class="form-label" for="field-name">Name</label>
              <input
                class="form-input"
                id="field-name"
                type="text"
                placeholder="e.g. Buffalo Trace"
                required
              />
              <span class="form-error" id="error-name"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="field-category">Category</label>
              <select class="form-select" id="field-category" required>
                <option value="">Select&hellip;</option>
              </select>
              <span class="form-error" id="error-category"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="field-subcategory">Subcategory</label>
              <select class="form-select" id="field-subcategory" required>
                <option value="">Select category first</option>
              </select>
              <span class="form-error" id="error-subcategory"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="field-unit">Unit</label>
              <select class="form-select" id="field-unit" required>
                <option value="">Select&hellip;</option>
                <option value="oz">oz</option>
                <option value="ml">ml</option>
                <option value="dash">dash</option>
                <option value="each">each</option>
                <option value="splash">splash</option>
              </select>
              <span class="form-error" id="error-unit"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="field-quantity">Quantity</label>
              <input
                class="form-input"
                id="field-quantity"
                type="number"
                min="0"
                step="0.25"
                value="0"
              />
              <span class="form-error" id="error-quantity"></span>
            </div>

            <div class="form-group">
              <div class="form-checkbox-row">
                <input class="form-checkbox" id="field-instock" type="checkbox" />
                <label class="form-checkbox-label" for="field-instock">In Stock</label>
              </div>
            </div>

            <div class="form-group">
              <label class="form-label" for="field-threshold">Low Stock Threshold</label>
              <input
                class="form-input"
                id="field-threshold"
                type="number"
                min="0"
                step="0.25"
                value="0"
              />
            </div>

            <div class="form-group full-width">
              <label class="form-label" for="field-tags">Tags (comma-separated)</label>
              <input
                class="form-input"
                id="field-tags"
                type="text"
                placeholder="e.g. bourbon, whiskey, american"
              />
            </div>

            <div class="form-group full-width">
              <label class="form-label" for="field-notes">Notes</label>
              <textarea
                class="form-textarea"
                id="field-notes"
                placeholder="Tasting notes, brand info&hellip;"
                rows="2"
              ></textarea>
            </div>

            <div class="form-group">
              <div class="form-checkbox-row">
                <input class="form-checkbox" id="field-shopping" type="checkbox" />
                <label class="form-checkbox-label" for="field-shopping"
                  >Shopping List Default</label
                >
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button class="btn-cancel" id="btn-cancel" type="button">Cancel</button>
            <button class="app-btn" id="btn-save" type="submit">Save</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Equipment modal overlay -->
    <div class="modal-overlay" id="modal-overlay-equip">
      <div
        class="modal-dialog modal-dialog-equipment"
        role="dialog"
        aria-labelledby="modal-title-equip"
      >
        <h2 class="modal-title" id="modal-title-equip">Add Equipment</h2>
        <form id="equipment-form" novalidate>
          <div class="form-grid">
            <div class="form-group full-width">
              <label class="form-label" for="eq-field-name">Name</label>
              <input
                class="form-input"
                id="eq-field-name"
                type="text"
                placeholder="e.g. Hawthorne Strainer"
                required
              />
              <span class="form-error" id="eq-error-name"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="eq-field-category">Category</label>
              <select class="form-select" id="eq-field-category" required>
                <option value="">Select&hellip;</option>
              </select>
              <span class="form-error" id="eq-error-category"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="eq-field-subcategory">Subcategory</label>
              <select class="form-select" id="eq-field-subcategory" required>
                <option value="">Select category first</option>
              </select>
              <span class="form-error" id="eq-error-subcategory"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="eq-field-quantity">Quantity</label>
              <input
                class="form-input"
                id="eq-field-quantity"
                type="number"
                min="0"
                step="1"
                value="1"
              />
              <span class="form-error" id="eq-error-quantity"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="eq-field-condition">Condition</label>
              <select class="form-select" id="eq-field-condition" required>
                <option value="">Select&hellip;</option>
                <option value="good">Good</option>
                <option value="fair">Fair</option>
                <option value="replace">Replace</option>
              </select>
              <span class="form-error" id="eq-error-condition"></span>
            </div>

            <div class="form-group full-width">
              <label class="form-label" for="eq-field-tags">Tags (comma-separated)</label>
              <input
                class="form-input"
                id="eq-field-tags"
                type="text"
                placeholder="e.g. stainless, cocktail, essential"
              />
            </div>

            <div class="form-group full-width">
              <label class="form-label" for="eq-field-notes">Notes</label>
              <textarea
                class="form-textarea"
                id="eq-field-notes"
                placeholder="Brand, material, size&hellip;"
                rows="2"
              ></textarea>
            </div>
          </div>

          <div class="form-actions">
            <button class="btn-cancel" id="btn-cancel-equip" type="button">Cancel</button>
            <button class="app-btn app-btn-equipment" id="btn-save-equip" type="submit">
              Save
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Recipe form modal overlay -->
    <div class="modal-overlay" id="modal-overlay-recipe">
      <div
        class="modal-dialog modal-dialog-recipe"
        role="dialog"
        aria-labelledby="modal-title-recipe"
      >
        <h2 class="modal-title" id="modal-title-recipe">Add Recipe</h2>
        <form id="recipe-form" novalidate>
          <div class="form-grid">
            <div class="form-group full-width">
              <label class="form-label" for="rec-field-name">Name</label>
              <input
                class="form-input"
                id="rec-field-name"
                type="text"
                placeholder="e.g. Old Fashioned"
                required
              />
              <span class="form-error" id="rec-error-name"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="rec-field-category">Category</label>
              <select class="form-select" id="rec-field-category" required>
                <option value="">Select&hellip;</option>
              </select>
              <span class="form-error" id="rec-error-category"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="rec-field-subcategory">Subcategory</label>
              <select class="form-select" id="rec-field-subcategory" required>
                <option value="">Select category first</option>
              </select>
              <span class="form-error" id="rec-error-subcategory"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="rec-field-glassware">Glassware</label>
              <input
                class="form-input"
                id="rec-field-glassware"
                type="text"
                placeholder="e.g. Rocks glass"
                required
              />
              <span class="form-error" id="rec-error-glassware"></span>
            </div>

            <div class="form-group">
              <label class="form-label" for="rec-field-servings">Servings</label>
              <input
                class="form-input"
                id="rec-field-servings"
                type="number"
                min="1"
                step="1"
                value="1"
                required
              />
              <span class="form-error" id="rec-error-servings"></span>
            </div>

            <div class="form-group full-width">
              <label class="form-label" for="rec-field-garnish">Garnish</label>
              <input
                class="form-input"
                id="rec-field-garnish"
                type="text"
                placeholder="e.g. Orange twist (leave blank if none)"
              />
            </div>

            <div class="form-group full-width">
              <label class="form-label" for="rec-field-description">Description</label>
              <textarea
                class="form-textarea"
                id="rec-field-description"
                placeholder="Brief tasting notes or background&hellip;"
                rows="2"
                required
              ></textarea>
              <span class="form-error" id="rec-error-description"></span>
            </div>

            <div class="form-group full-width">
              <label class="form-label" for="rec-field-instructions">Instructions</label>
              <textarea
                class="form-textarea"
                id="rec-field-instructions"
                placeholder="Step-by-step instructions&hellip;"
                rows="5"
                required
              ></textarea>
              <span class="form-error" id="rec-error-instructions"></span>
            </div>

            <div class="form-group full-width">
              <label class="form-label" for="rec-field-tags">Tags (comma-separated)</label>
              <input
                class="form-input"
                id="rec-field-tags"
                type="text"
                placeholder="e.g. classic, stirred, whiskey"
              />
            </div>

            <div class="form-group full-width">
              <label class="form-label" for="rec-field-source">Source / Attribution</label>
              <input
                class="form-input"
                id="rec-field-source"
                type="text"
                placeholder="e.g. Death &amp; Co., Cocktail Codex p.42"
              />
            </div>

            <div class="form-group">
              <div class="form-checkbox-row">
                <input class="form-checkbox" id="rec-field-favorite" type="checkbox" />
                <label class="form-checkbox-label" for="rec-field-favorite">&#9733; Favorite</label>
              </div>
            </div>
          </div>

          <!-- Ingredient Selector -->
          <div class="selector-section">
            <div class="selector-section-header">
              <span class="selector-section-title">Ingredients</span>
              <span class="form-error" id="rec-error-ingredients"></span>
            </div>
            <div class="selector-search-wrapper">
              <input
                class="form-input selector-search-input"
                id="rec-ing-search"
                type="text"
                placeholder="Search ingredients to add&hellip;"
                autocomplete="off"
              />
              <div class="selector-dropdown hidden" id="rec-ing-dropdown"></div>
            </div>
            <div class="selected-list" id="rec-selected-ingredients"></div>
          </div>

          <!-- Equipment Selector -->
          <div class="selector-section">
            <div class="selector-section-header">
              <span class="selector-section-title">Equipment</span>
            </div>
            <div class="selector-search-wrapper">
              <input
                class="form-input selector-search-input"
                id="rec-equip-search"
                type="text"
                placeholder="Search equipment to add&hellip;"
                autocomplete="off"
              />
              <div class="selector-dropdown hidden" id="rec-equip-dropdown"></div>
            </div>
            <div class="selected-list" id="rec-selected-equipment"></div>
          </div>

          <div class="form-actions">
            <button class="btn-cancel" id="btn-cancel-recipe" type="button">Cancel</button>
            <button class="app-btn app-btn-recipe" id="btn-save-recipe" type="submit">Save</button>
          </div>
        </form>
      </div>
    </div>

    <!-- Recipe detail modal overlay -->
    <div class="modal-overlay" id="modal-overlay-recipe-detail">
      <div
        class="modal-dialog modal-dialog-recipe modal-dialog-recipe-detail"
        role="dialog"
        aria-labelledby="modal-title-recipe-detail"
      >
        <div class="recipe-detail-header">
          <h2 class="modal-title" id="modal-title-recipe-detail"></h2>
          <div class="recipe-detail-header-actions">
            <button class="btn-icon btn-edit" id="btn-detail-edit" type="button">Edit</button>
            <button class="btn-icon btn-delete" id="btn-detail-delete" type="button">Delete</button>
            <button class="btn-cancel" id="btn-detail-close" type="button">Close</button>
          </div>
        </div>
        <div id="recipe-detail-body"></div>
      </div>
    </div>

    <!-- Amphora level popover -->
    <div class="amphora-popover" id="amphora-popover">
      <div class="amphora-popover-title">Bottle Level</div>
      <div class="amphora-level-options" id="amphora-level-options"></div>
    </div>

    <!-- Shared header component -->
    <script src="/js/components/app-header.js"></script>

    <!-- Symposium modules (load order matters) -->
    <script src="/apps/symposium/js/state.js"></script>
    <script src="/apps/symposium/js/firestore.js"></script>
    <script src="/apps/symposium/js/amphora.js"></script>
    <script src="/apps/symposium/js/ingredients.js"></script>
    <script src="/apps/symposium/js/equipment.js"></script>
    <script src="/apps/symposium/js/inventory.js"></script>
    <script src="/apps/symposium/js/recipes.js"></script>
    <script src="/apps/symposium/js/app.js"></script>

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        firebase.auth().onAuthStateChanged(function (user) {
          if (!user) {
            window.location.href = '/';
            return;
          }

          // Render the shared header
          window.OlympusHeader.render('The Symposium');

          // Hide loading, show main content
          document.getElementById('app-loading').classList.add('hidden');
          document.getElementById('app-main').classList.remove('hidden');

          // Initialize the app
          window.Symposium.app.init();
        });
      });
    </script>
  </body>
</html>
